### YamlMime:UniversalReference
ms.openlocfilehash: a39dfef24ce7d23cf814942fed14481490ece6d0
ms.sourcegitcommit: beffe9455dace422e85b92f0105c54ff7b594cbf
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2018
ms.locfileid: "24043231"
items:
- uid: office.Office.AddinCommands.Event
  summary: <span data-ttu-id="e4c90-p101">L’objet event est transmis en tant que paramètre aux fonctions de complément appelées par des boutons de commande sans interface utilisateur. Cet objet permet au complément d’identifier le bouton sur lequel l’utilisateur a cliqué et d’informer l’hôte que son traitement est terminé.</span><span class="sxs-lookup"><span data-stu-id="e4c90-p101">The event object is passed as a parameter to add-in functions invoked by UI-less command buttons. The object allows the add-in to identify which button was clicked and to signal the host that it has completed its processing.</span></span>
  remarks: >-
    <table><tr><td><span data-ttu-id="e4c90-103">Type de complément</span><span class="sxs-lookup"><span data-stu-id="e4c90-103">Add-in type</span></span></td><td><span data-ttu-id="e4c90-104">De contenu, de volet de tâche, Outlook</span><span class="sxs-lookup"><span data-stu-id="e4c90-104">Content, task pane, Outlook</span></span></td></tr>


    <tr><td>[<span data-ttu-id="e4c90-105">Niveau d’autorisation minimal</span><span class="sxs-lookup"><span data-stu-id="e4c90-105">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="e4c90-106">Restricted</span><span class="sxs-lookup"><span data-stu-id="e4c90-106">Restricted</span></span></td></tr>


    <tr><td>[<span data-ttu-id="e4c90-107">Mode Outlook applicable</span><span class="sxs-lookup"><span data-stu-id="e4c90-107">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="e4c90-108">Composition ou lecture</span><span class="sxs-lookup"><span data-stu-id="e4c90-108">Compose or Read</span></span></td></tr></table>
  name: Office.AddinCommands.Event
  fullName: office.Office.AddinCommands.Event
  langs:
  - typeScript
  type: interface
  package: office
  children:
  - office.Office.AddinCommands.Event.completed
  - office.Office.AddinCommands.Event.source
- uid: office.Office.AddinCommands.Event.completed
  summary: >-
    <span data-ttu-id="e4c90-109">Indique que le complément a terminé le traitement déclenché par le bouton de commande d’un complément ou par le gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="e4c90-109">Indicates that the add-in has completed processing that was triggered by an add-in command button or event handler.</span></span>


    <span data-ttu-id="e4c90-p102">Cette méthode doit être appelée à la fin d’une fonction qui a été appelée par une commande de complément définie avec un élément Action avec un attribut xsi:type ayant la valeur ExecuteFunction. Appeler cette méthode indique au client hôte que la fonction est terminée et qu’il peut nettoyer les états figurant dans l’appel de la fonction. Par exemple, si l’utilisateur ferme Outlook avant l’appel de cette méthode, Outlook vous avertit qu’une fonction est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="e4c90-p102">This method must be called at the end of a function which was invoked by an add-in command defined with an Action element with an xsi:type attribute set to ExecuteFunction. Calling this method signals the host client that the function is complete and that it can clean up any state involved with invoking the function. For example, if the user closes Outlook before this method is called, Outlook will warn that a function is still executing.</span></span>


    <span data-ttu-id="e4c90-113">Cette méthode doit être appelée dans un gestionnaire d’événements, ajouté via la méthode Office.context.mailbox.addHandlerAsync à l’issue du traitement de l’événement.</span><span class="sxs-lookup"><span data-stu-id="e4c90-113">This method must be called in an event handler added via Office.context.mailbox.addHandlerAsync after completing processing of the event.</span></span>


    <span data-ttu-id="e4c90-114">\[[Du jeu d’API : boîte aux lettres 1.3](/javascript/office/javascript-api-for-office)\]</span><span class="sxs-lookup"><span data-stu-id="e4c90-114">\[ [API set: Mailbox 1.3](/javascript/office/javascript-api-for-office) \]</span></span>
  remarks: >-
    <table><tr><td>[<span data-ttu-id="e4c90-115">Niveau d’autorisation minimal</span><span class="sxs-lookup"><span data-stu-id="e4c90-115">Minimum permission level</span></span>](https://docs.microsoft.com/outlook/add-ins/understanding-outlook-add-in-permissions)</td><td><span data-ttu-id="e4c90-116">Restricted</span><span class="sxs-lookup"><span data-stu-id="e4c90-116">Restricted</span></span></td></tr>


    <tr><td>[<span data-ttu-id="e4c90-117">Mode Outlook applicable</span><span class="sxs-lookup"><span data-stu-id="e4c90-117">Applicable Outlook mode</span></span>](https://docs.microsoft.com/outlook/add-ins/#extension-points)</td><td><span data-ttu-id="e4c90-118">Composition ou lecture</span><span class="sxs-lookup"><span data-stu-id="e4c90-118">Compose or read</span></span></td></tr></table>


    <span data-ttu-id="e4c90-119">**Informations de prise en charge**</span><span class="sxs-lookup"><span data-stu-id="e4c90-119">**Support details**</span></span>


    <span data-ttu-id="e4c90-p103">Un Y majuscule dans la matrice suivante indique que cette méthode est prise en charge dans l'application hôte Office correspondante. Une cellule vide indique que l'application hôte Office ne prend pas en charge cette méthode.</span><span class="sxs-lookup"><span data-stu-id="e4c90-p103">A capital Y in the following matrix indicates that this method is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this method.</span></span>


    <span data-ttu-id="e4c90-122">Pour plus d’informations sur les exigences des applications et le serveur hôte Office, voir [Configuration requise pour exécuter des compléments Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span><span class="sxs-lookup"><span data-stu-id="e4c90-122">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="e4c90-123">*Hôtes pris en charge par la plateforme*</span><span class="sxs-lookup"><span data-stu-id="e4c90-123">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="e4c90-124">Office pour Bureau Windows</span><span class="sxs-lookup"><span data-stu-id="e4c90-124">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="e4c90-125">Office Online (dans un navigateur)</span><span class="sxs-lookup"><span data-stu-id="e4c90-125">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="e4c90-126">Office pour iPad</span><span class="sxs-lookup"><span data-stu-id="e4c90-126">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="e4c90-127"><strong>Excel</strong></span><span class="sxs-lookup"><span data-stu-id="e4c90-127"><strong> Excel </strong></span></span></td><td> <span data-ttu-id="e4c90-128">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-128">Y</span></span> </td><td> <span data-ttu-id="e4c90-129">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-129">Y</span></span> </td><td> <span data-ttu-id="e4c90-130">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-130">Y</span></span> </td></tr> <tr><td><span data-ttu-id="e4c90-131"><strong>Outlook</strong></span><span class="sxs-lookup"><span data-stu-id="e4c90-131"><strong> Outlook </strong></span></span></td><td> <span data-ttu-id="e4c90-132">Y (boîte aux lettres 1.3)</span><span class="sxs-lookup"><span data-stu-id="e4c90-132">Y (Mailbox 1.3)</span></span> </td><td> </td><td> </td></tr> <tr><td><span data-ttu-id="e4c90-133"><strong>PowerPoint</strong></span><span class="sxs-lookup"><span data-stu-id="e4c90-133"><strong> PowerPoint </strong></span></span></td><td> <span data-ttu-id="e4c90-134">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-134">Y</span></span> </td><td> <span data-ttu-id="e4c90-135">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-135">Y</span></span> </td><td> <span data-ttu-id="e4c90-136">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-136">Y</span></span> </td></tr> <tr><td><span data-ttu-id="e4c90-137"><strong>Word</strong></span><span class="sxs-lookup"><span data-stu-id="e4c90-137"><strong> Word </strong></span></span></td><td> <span data-ttu-id="e4c90-138">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-138">Y</span></span> </td><td> <span data-ttu-id="e4c90-139">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-139">Y</span></span> </td><td> <span data-ttu-id="e4c90-140">Y</span><span class="sxs-lookup"><span data-stu-id="e4c90-140">Y</span></span> </td></tr> </table>

    #### <a name="examples"></a><span data-ttu-id="e4c90-141">Exemples</span><span class="sxs-lookup"><span data-stu-id="e4c90-141">Examples</span></span>


    ```javascript

    function processItem (event) {
        // Do some processing

        event.completed();
    }


    // In the following example, the checkMessage function has

    // been registered as an event handler for ItemSend.

    function checkMessage(event) {
        // Get the item being sent
        var outgoingMsg = Office.context.mailbox.item;

        // Check if subject contains "BLOCK"
        outgoingMsg.subject.getAsync(function (result) {
            // Subject is in result.value
            if (result.value.indexOf('BLOCK') != -1) {
                // Value is found, stop send
                event.completed({allowEvent = false});
            } else {
                // Value wasn't found, allow send
                event.completed({allowEvent = true});
            }
        });
    }

    ```
  name: completed(options)
  fullName: office.Office.AddinCommands.Event.completed
  langs:
  - typeScript
  type: method
  syntax:
    content: 'completed(options?: any): void;'
    return:
      type:
      - void
      description: ''
    parameters:
    - id: options
      description: '<span data-ttu-id="e4c90-142">Facultatif.</span><span class="sxs-lookup"><span data-stu-id="e4c90-142">Optional.</span></span> <span data-ttu-id="e4c90-143">Littéral d’objet contenant une ou plusieurs des propriétés suivantes.</span><span class="sxs-lookup"><span data-stu-id="e4c90-143">An object literal that contains one or more of the following properties.</span></span> <span data-ttu-id="e4c90-144">allowEvent : une valeur de type boolean.</span><span class="sxs-lookup"><span data-stu-id="e4c90-144">allowEvent: A boolean value.</span></span> <span data-ttu-id="e4c90-145">Lorsque la méthode achevée est utilisée pour signaler l’achèvement d’un gestionnaire d’événements, que cette valeur indique de l’événement géré doit poursuivre l’exécution ou être annulée.</span><span class="sxs-lookup"><span data-stu-id="e4c90-145">When the completed method is used to signal completion of an event handler, this value indicates of the handled event should continue execution or be canceled.</span></span> <span data-ttu-id="e4c90-146">Par exemple, un complément qui gère l’événement ItemSend peut définir allowEvent = false pour annuler l’envoi du message.</span><span class="sxs-lookup"><span data-stu-id="e4c90-146">For example, an add-in that handles the ItemSend event can set allowEvent = false to cancel sending of the message.</span></span>'
      type:
      - any
- uid: office.Office.AddinCommands.Event.source
  summary: >-
    <span data-ttu-id="e4c90-147">Informations sur le contrôle qui a déclenché l’appel de cette fonction.</span><span class="sxs-lookup"><span data-stu-id="e4c90-147">Information about the control that triggered calling this function.</span></span>


    <span data-ttu-id="e4c90-148">**Informations de prise en charge**</span><span class="sxs-lookup"><span data-stu-id="e4c90-148">**Support details**</span></span>


    <span data-ttu-id="e4c90-p105">Un Y majuscule dans la matrice suivante indique que cette propriété est prise en charge dans l'application hôte Office correspondante. Une cellule vide indique que l'application hôte Office ne prend pas en charge cette propriété.</span><span class="sxs-lookup"><span data-stu-id="e4c90-p105">A capital Y in the following matrix indicates that this property is supported in the corresponding Office host application. An empty cell indicates that the Office host application doesn't support this property.</span></span>


    <span data-ttu-id="e4c90-151">Pour plus d’informations sur les exigences des applications et le serveur hôte Office, voir [Configuration requise pour exécuter des compléments Office](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span><span class="sxs-lookup"><span data-stu-id="e4c90-151">For more information about Office host application and server requirements, see [Requirements for running Office Add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/requirements-for-running-office-add-ins)<!-- -->.</span></span>


    <span data-ttu-id="e4c90-152">*Hôtes pris en charge par la plateforme*</span><span class="sxs-lookup"><span data-stu-id="e4c90-152">*Supported hosts, by platform*</span></span> <table> <tr><th> </th><th> <span data-ttu-id="e4c90-153">Office pour Bureau Windows</span><span class="sxs-lookup"><span data-stu-id="e4c90-153">Office for Windows desktop</span></span> </th><th> <span data-ttu-id="e4c90-154">Office Online (dans un navigateur)</span><span class="sxs-lookup"><span data-stu-id="e4c90-154">Office Online (in browser)</span></span> </th><th> <span data-ttu-id="e4c90-155">Office pour iPad</span><span class="sxs-lookup"><span data-stu-id="e4c90-155">Office for iPad</span></span> </th></tr> <tr><td><span data-ttu-id="e4c90-156"><strong>Outlook</strong></span><span class="sxs-lookup"><span data-stu-id="e4c90-156"><strong> Outlook </strong></span></span></td><td> <span data-ttu-id="e4c90-157">Y (boîte aux lettres 1.3)</span><span class="sxs-lookup"><span data-stu-id="e4c90-157">Y (Mailbox 1.3)</span></span> </td><td> </td><td> </td></tr> </table>
  name: source
  fullName: office.Office.AddinCommands.Event.source
  langs:
  - typeScript
  type: property
  syntax:
    content: 'source: Source;'
    return:
      type:
      - office.Office.AddinCommands.Source
      description: "\n#### <a name=\"examples\"></a><span data-ttu-id=\"e4c90-158\">範例</span><span class=\"sxs-lookup\"><span data-stu-id=\"e4c90-158\">Examples</span></span>\n\n```javascript\n// In this example, consider a button defined in an add-in manifest as follows:\n<Control xsi:type=\"Button\" id=\"eventTestButton\">\n    <Label resid=\"eventButtonLabel\" />\n    <Tooltip resid=\"eventButtonTooltip\" />\n    <Supertip>\n        <Title resid=\"eventSuperTipTitle\" />\n        <Description resid=\"eventSuperTipDescription\" />\n    </Supertip>\n    <Icon>\n        <bt:Image size=\"16\" resid=\"blue-icon-16\" />\n        <bt:Image size=\"32\" resid=\"blue-icon-32\" />\n        <bt:Image size=\"80\" resid=\"blue-icon-80\" />\n    </Icon>\n    <Action xsi:type=\"ExecuteFunction\">\n        <FunctionName>testEventObject</FunctionName>\n    </Action>\n</Control>\n// The button has an id attribute set to eventTestButton, and will invoke\n// the testEventObject function defined in the add-in.\n// That function looks like this:\nfunction testEventObject(event) {\n    // The event object implements the Event interface\n\n    // This value will be \"eventTestButton\"\n    var buttonId = event.source.id;\n\n    // Signal to the host app that processing is complete.\n    event.completed();\n}\n```\n```javascript\n// Function is used by two buttons:\n// button1 and button2\nfunction multiButton (event) {\n    // Check which button was clicked\n    var buttonId = event.source.id;\n\n    if (buttonId === 'button1') {\n        doButton1Action();\n    }\n    else {\n        doButton2Action();\n    }\n\n    event.completed();\n}\n```"
