# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="50da7-101">Comment la documentation de l’API JavaScript pour Office est générée</span><span class="sxs-lookup"><span data-stu-id="50da7-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="50da7-102">Les pages de documentation de référence JavaScript Office sont générées à partir de fichiers de définition de type et d’extraits d’exemples.</span><span class="sxs-lookup"><span data-stu-id="50da7-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="50da7-103">Ce processus utilise un mélange d’outils open source et de scripts spécifiques au référentiel.</span><span class="sxs-lookup"><span data-stu-id="50da7-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="50da7-104">Ce document a pour but de simplifier les processus de ce référentiel afin que la Communauté puisse tirer le meilleur parti et contribuer à ce contenu.</span><span class="sxs-lookup"><span data-stu-id="50da7-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="50da7-105">Sources de contenu</span><span class="sxs-lookup"><span data-stu-id="50da7-105">Content sources</span></span>

<span data-ttu-id="50da7-106">Deux types de contenu sont combinés pour créer la documentation de référence Office-JS : définitions de types et extraits de code.</span><span class="sxs-lookup"><span data-stu-id="50da7-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="50da7-107">Elles garantissent une couverture complète de l’API et donnent des exemples de code incorporés de petite taille.</span><span class="sxs-lookup"><span data-stu-id="50da7-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="50da7-108">Fichiers de définition de type</span><span class="sxs-lookup"><span data-stu-id="50da7-108">Type definition files</span></span>

<span data-ttu-id="50da7-109">Les fichiers de définition de type sur la base d’une [saisie définitive](https://github.com/DefinitelyTyped/DefinitelyTyped) représentent la seule source de vérité pour la documentation.</span><span class="sxs-lookup"><span data-stu-id="50da7-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="50da7-110">N’importe quel complément Office qui utilise une compilation d’appel à l’aide de ces fichiers de définition de type.</span><span class="sxs-lookup"><span data-stu-id="50da7-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="50da7-111">Elles donnent également aux développeurs JavaScript et de la machine à écrire des fonctionnalités IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="50da7-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="50da7-112">En construisant la documentation de référence à partir de ces définitions, nous fournissons des informations plus précises.</span><span class="sxs-lookup"><span data-stu-id="50da7-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="50da7-113">Il existe quatre fichiers d. TS pertinents qui fournissent le contenu source de différentes sous-sections des documents.</span><span class="sxs-lookup"><span data-stu-id="50da7-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="50da7-114">[Office-js/index. d. TS](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (définitions de publication)</span><span class="sxs-lookup"><span data-stu-id="50da7-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="50da7-115">Excel (version Release)</span><span class="sxs-lookup"><span data-stu-id="50da7-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="50da7-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="50da7-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="50da7-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="50da7-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="50da7-118">Visio</span><span class="sxs-lookup"><span data-stu-id="50da7-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="50da7-119">Word (publication)</span><span class="sxs-lookup"><span data-stu-id="50da7-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="50da7-120">Sous-section OfficeExtensions de l’API commune</span><span class="sxs-lookup"><span data-stu-id="50da7-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="50da7-121">[Office-js-aperçu/index. d. TS](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (les définitions d’aperçu.)</span><span class="sxs-lookup"><span data-stu-id="50da7-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="50da7-122">Excel (aperçu)</span><span class="sxs-lookup"><span data-stu-id="50da7-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="50da7-123">Outlook (aperçu)</span><span class="sxs-lookup"><span data-stu-id="50da7-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="50da7-124">Word (aperçu)</span><span class="sxs-lookup"><span data-stu-id="50da7-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="50da7-125">API communes</span><span class="sxs-lookup"><span data-stu-id="50da7-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="50da7-126">[Custom-Functions-Runtime/index. d. TS](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (les définitions d’exécution des fonctions personnalisées Excel.)</span><span class="sxs-lookup"><span data-stu-id="50da7-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="50da7-127">Fonctions personnalisées</span><span class="sxs-lookup"><span data-stu-id="50da7-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="50da7-128">[Office-Runtime/index. d. TS](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (les définitions d’exécution Office pour la plateforme de fonctions personnalisées.)</span><span class="sxs-lookup"><span data-stu-id="50da7-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="50da7-129">Office Runtime</span><span class="sxs-lookup"><span data-stu-id="50da7-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="50da7-130">Les versions antérieures des API ont leurs propres fichiers d. TS.</span><span class="sxs-lookup"><span data-stu-id="50da7-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="50da7-131">Ces éléments sont conservés lorsqu’un nouvel ensemble de conditions requises de l’API est publié.</span><span class="sxs-lookup"><span data-stu-id="50da7-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="50da7-132">Ils peuvent également être générés à l’aide de l' [outil de suppression de version](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span><span class="sxs-lookup"><span data-stu-id="50da7-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="50da7-133">Ces anciens fichiers d. TS sont conservés de sorte que, dans les API d’événements, les correctifs ou les modifications soient toujours traités.</span><span class="sxs-lookup"><span data-stu-id="50da7-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="50da7-134">Cette fonctionnalité est utile si vous devez cibler une version plus ancienne de l’API.</span><span class="sxs-lookup"><span data-stu-id="50da7-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="50da7-135">Test des modifications apportées au fichier de définition de type</span><span class="sxs-lookup"><span data-stu-id="50da7-135">Testing type definition file changes</span></span>

<span data-ttu-id="50da7-136">Toutes les modifications apportées à la documentation pour l’API JavaScript Office sont effectuées en modifiant les quatre fichiers de la version d. TS mentionnés ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="50da7-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="50da7-137">Toutefois, vous pouvez tester une modification avant d’envoyer un PR à DefinitelyTyped (si vous le souhaitez, par exemple, tester le mode de conversion de votre mise en forme en démarque) en modifiant le fichier correspondant dans [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) et en exécutant [GenerateDocs. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span><span class="sxs-lookup"><span data-stu-id="50da7-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="50da7-138">Lorsque vous y êtes invité, sélectionnez l’option « fichiers locaux ».</span><span class="sxs-lookup"><span data-stu-id="50da7-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="50da7-139">Si vous poussez les modifications vers une branche distante de cette référentiel, la plateforme docs.microsoft.com crée une branche de test.</span><span class="sxs-lookup"><span data-stu-id="50da7-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="50da7-140">Cette branche est rendue sur review.docs.microsoft.com, qui est uniquement accessible par le personnel de Microsoft interne.</span><span class="sxs-lookup"><span data-stu-id="50da7-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="50da7-141">Toute personne qui examine votre PR vérifiera la précision du site de révision.</span><span class="sxs-lookup"><span data-stu-id="50da7-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="50da7-142">Extraits de code</span><span class="sxs-lookup"><span data-stu-id="50da7-142">Code snippets</span></span>

<span data-ttu-id="50da7-143">Des extraits de code d’exemple de code sont ajoutés aux pages de référence à partir de deux sources :</span><span class="sxs-lookup"><span data-stu-id="50da7-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="50da7-144">Exemples de laboratoire de script</span><span class="sxs-lookup"><span data-stu-id="50da7-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="50da7-145">Extraits de code locaux</span><span class="sxs-lookup"><span data-stu-id="50da7-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="50da7-146">Les extraits de code locaux se trouvent dans des fichiers YAML spécifiques à l’hôte.</span><span class="sxs-lookup"><span data-stu-id="50da7-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="50da7-147">Leur contenu est organisé par classe et par champ, de sorte qu’il peut être mappé à l’emplacement approprié dans une page de référence.</span><span class="sxs-lookup"><span data-stu-id="50da7-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="50da7-148">La langue de l’extrait de code (JavaScript ou machine à écrire) est déduite par l’utilisation d’instructions await.</span><span class="sxs-lookup"><span data-stu-id="50da7-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="50da7-149">Les extraits de code d’atelier de script sont extraits des exemples de travail.</span><span class="sxs-lookup"><span data-stu-id="50da7-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="50da7-150">Actuellement, Excel, Outlook et les exemples Word sont mappés aux sections de document de référence par le biais de [fichiers de mappage](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span><span class="sxs-lookup"><span data-stu-id="50da7-150">Currently, Excel, Outlook, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span></span> <span data-ttu-id="50da7-151">Ces méthodes correspondent aux propriétés ou méthodes de l’API.</span><span class="sxs-lookup"><span data-stu-id="50da7-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="50da7-152">Lorsque le référentiel Office-js-snippets est `yarn start` exécuté, [un fichier YAML](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) contenant tous les extraits de code mappés est créé.</span><span class="sxs-lookup"><span data-stu-id="50da7-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="50da7-153">Ce fichier YAML est l’entrée dans les outils de documentation de référence.</span><span class="sxs-lookup"><span data-stu-id="50da7-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="50da7-154">Pipeline d’outils</span><span class="sxs-lookup"><span data-stu-id="50da7-154">Tooling pipeline</span></span>

![Image illustrant le flux de contrôle à partir de la saisie définitive, au préprocesseur, à l’extracteur d’API, à midprocessor, au documenteur de l’API et par rapport au postprocesseur.](ToolingPipeline.png)

<span data-ttu-id="50da7-156">Entre les sources de contenu et les pages finales, le contenu de la documentation passe par cinq étapes d’outils :</span><span class="sxs-lookup"><span data-stu-id="50da7-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="50da7-157">Script du préprocesseur</span><span class="sxs-lookup"><span data-stu-id="50da7-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="50da7-158">Extracteur d’API</span><span class="sxs-lookup"><span data-stu-id="50da7-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="50da7-159">Script Midprocessor</span><span class="sxs-lookup"><span data-stu-id="50da7-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="50da7-160">Documentation de l’API</span><span class="sxs-lookup"><span data-stu-id="50da7-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="50da7-161">Script de postprocesseur</span><span class="sxs-lookup"><span data-stu-id="50da7-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="50da7-162">Le préprocesseur prend les fichiers d. TS et les divise en sections spécifiques à l’hôte.</span><span class="sxs-lookup"><span data-stu-id="50da7-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="50da7-163">Il effectue tout nettoyage nécessaire aux outils suivants pour traiter correctement les données.</span><span class="sxs-lookup"><span data-stu-id="50da7-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="50da7-164">L’extracteur d’API convertit les fichiers d. TS en données JSON.</span><span class="sxs-lookup"><span data-stu-id="50da7-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="50da7-165">Cela régit toutes les données de type, ce qui facilite l’analyse.</span><span class="sxs-lookup"><span data-stu-id="50da7-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="50da7-166">Le midprocessor récupère les extraits de code et les associe aux hôtes appropriés, et nettoie la liaison croisée entre Outlook et les objets d’API courants.</span><span class="sxs-lookup"><span data-stu-id="50da7-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="50da7-167">L’API documenter convertit les données JSON en fichiers. yml.</span><span class="sxs-lookup"><span data-stu-id="50da7-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="50da7-168">Les fichiers. yml sont convertis en démarques par le système de publication ouvert qui publie nos documents sur docs.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="50da7-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="50da7-169">L’API documenter contient également une extension spécifique à Office qui insère nos extraits de code.</span><span class="sxs-lookup"><span data-stu-id="50da7-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="50da7-170">Le postprocesseur nettoie la table des matières et déplace les fichiers. yml dans le dossier de [publication](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span><span class="sxs-lookup"><span data-stu-id="50da7-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="50da7-171">Ces cinq étapes sont exécutées lors de l’exécution de [GenerateDocs. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) .</span><span class="sxs-lookup"><span data-stu-id="50da7-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="50da7-172">Ce script gère également l’installation du module de nœud, nettoie les anciens ensembles de fichiers et les fichiers de définition de type versions pour chaque ensemble de conditions requises.</span><span class="sxs-lookup"><span data-stu-id="50da7-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
